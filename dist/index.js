"use strict";import{jsx as n,jsxs as d}from"react/jsx-runtime";import{useRef as w,useState as u}from"react";import s from"./index.module.css";const h=210,k=10,W=["January","February","March","April","May","June","July","August","September","October","November","December"],A=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Y=0;function _(e,l){return new Date(e,l,0).getDate()}function E(e,l){return new Date(e+"-"+l+"-01").getDay()}function N(e){return n("div",{onClick:()=>e.onClick?.(),className:[s.calendarDay,...e.dayNumber?["_isHoverable"]:[],...e.isSelected?["_isSelected"]:[],...e.calendarDayClassName?[e.calendarDayClassName]:[]].join(" "),children:e.dayNumber??e.contents})}function c(){return n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:n("path",{d:"M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"})})}export default function T(e){const l=w(null),C=w(null),[a,S]=u(new Date(`${e.value}`)),[m,f]=u(!1),[y,b]=u(!m),[v,F]=u({top:!1,left:!1});function M(){I(),b(!1),setTimeout(()=>{f(!0),window.addEventListener("click",g)},0)}function g(t){t?.target&&l.current?.contains(t.target)||(f(!1),setTimeout(()=>{window.removeEventListener("click",g)},0),setTimeout(()=>{b(!0)},e.transitionDuration??h))}function I(){setTimeout(()=>{const t=l.current?.getBoundingClientRect(),r=C.current?.getBoundingClientRect();if(!t||!r)throw new Error("No rect found");const i=e.gapBetweenInputWrapperAndCalendar??k,{height:P}=r;F({top:t.top+t.height+i+P>window.innerHeight,left:t.left+t.width+i>window.innerWidth})},0)}function o(t,r,i){r>12&&(r=1,t++),r<=0&&(r=12,t--),S(new Date(`${t}-${r}-${i}`))}function R(t,r,i){o(t,r,i),e.onDateUpdate(new Date(`${t}-${r}-${i}`).toISOString()),g()}const D=new Date(e.value);return d("div",{ref:l,className:[s.DatePicker,...m?["_isOpened"]:[],...e.datePickerClassName?[e.datePickerClassName]:[]].join(" "),style:{"--transition-duration":`${e.transitionDuration??h}ms`,"--gap-between-input-wrapper-and-calendar":`${e.gapBetweenInputWrapperAndCalendar??k}px`},children:[n("div",{className:[s.inputWrapper,...e.inputWrapperClassName?[e.inputWrapperClassName]:[]].join(" "),onClick:()=>m?null:M(),children:n("input",{type:"text",value:e.toHumanDate?e.toHumanDate(a):a.toLocaleDateString(),readOnly:!0})}),d("div",{ref:C,className:[s.calendar,...v.top?["_isRevealedFromBottom"]:[],...v.left?["_isRevealedFromRight"]:[],...y?["_isRemovedFromLayout"]:[],...e.calendarClassName?[e.calendarClassName]:[]].join(" "),style:{zIndex:y?void 0:999999},children:[d("div",{className:[s.timePeriodSelector,...e.timePeriodSelectorClassName?[e.timePeriodSelectorClassName]:[]].join(" "),children:[n("button",{type:"button",className:"_isZeroed",onClick:()=>o(a.getFullYear(),a.getMonth(),a.getDate()),children:e.arrowIcon??n(c,{})}),n("span",{children:(e.monthNames??W)[a.getMonth()]}),n("button",{type:"button",className:"_isZeroed",onClick:()=>o(a.getFullYear(),a.getMonth()+2,a.getDate()),children:e.arrowIcon??n(c,{})})]}),d("div",{className:[s.timePeriodSelector,...e.timePeriodSelectorClassName?[e.timePeriodSelectorClassName]:[]].join(" "),children:[n("button",{type:"button",className:"_isZeroed",onClick:()=>o(a.getFullYear()-1,a.getMonth()+1,a.getDate()),children:e.arrowIcon??n(c,{})}),n("span",{children:a.getFullYear()}),n("button",{type:"button",className:"_isZeroed",onClick:()=>o(a.getFullYear()+1,a.getMonth()+1,a.getDate()),children:e.arrowIcon??n(c,{})})]}),d("div",{className:[s.calendarDaysGrid,...e.calendarDaysGridClassName?[e.calendarDaysGridClassName]:[]].join(" "),children:[(e.weekdayNames??A).map(t=>n(N,{contents:t,calendarDayClassName:e.calendarDayClassName},t)),Array.from(Array((E(a.getFullYear(),a.getMonth()+1)||7)-(e.weekStart??Y)).keys()).map(t=>n(N,{contents:"",calendarDayClassName:e.calendarDayClassName},t)),Array.from(Array(_(a.getFullYear(),a.getMonth()+1)).keys()).map(t=>n(N,{dayNumber:t+1,onClick:()=>R(a.getFullYear(),a.getMonth()+1,t+1),isSelected:a.getFullYear()===D.getFullYear()&&a.getMonth()===D.getMonth()&&t+1===D.getDate(),calendarDayClassName:e.calendarDayClassName},t+1))]})]})]})}
